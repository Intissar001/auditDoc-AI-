spring:
  main:
    web-application-type: NONE
    banner-mode: console
    lazy-initialization: false

  mail:
    host: smtp.gmail.com
    port: 587
    username: aichaelkhddar03@gmail.com
    password: ftvdiawbiywcoikl
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

  datasource:
    # Option A: Supabase avec failsafe
    url: jdbc:postgresql://aws-1-eu-west-1.pooler.supabase.com:5432/postgres?sslmode=require&connectTimeout=60&socketTimeout=60&loginTimeout=60
    # Option B: Base de données locale (décommentez pour développement)
    # url: jdbc:postgresql://localhost:5432/auditdoc_db

    username: postgres.ziyevqgoffoejasscxyg
    password: WcDmGFscwNTZL6pY
    driver-class-name: org.postgresql.Driver

    hikari:
      auto-commit: false
      maximum-pool-size: 3
      minimum-idle: 0
      idle-timeout: 30000
      max-lifetime: 600000
      connection-timeout: 60000
      validation-timeout: 10000
      leak-detection-threshold: 60000
      initialization-fail-timeout: -1  # Ne pas échouer au démarrage
      connection-test-query: SELECT 1
      data-source-properties:
        socketTimeout: 60000
        connectTimeout: 60000
        loginTimeout: 60
        tcpKeepAlive: true

  jpa:
    database: POSTGRESQL
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    open-in-view: false
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
        jdbc:
          batch_size: 20
          fetch_size: 50
          lob:
            non_contextual_creation: true
        connection:
          provider_disables_autocommit: true

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 50MB

  sql:
    init:
      mode: never

ai:
  ollama:
    base-url: http://localhost:11434
    model: llama3
    timeout: 300000
  provider: ollama
  max-tokens: 2000
  temperature: 0.7

logging:
  level:
    com.yourapp: INFO
    org.springframework: WARN
    org.hibernate.SQL: WARN
    com.zaxxer.hikari: DEBUG  # Pour voir les détails de connexion

  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

  file:
    name: logs/auditdoc-ai.log

app:
  name: AuditDoc AI
  version: 1.0.0
  base-url: http://localhost:8080
  upload:
    max-files: 10
    allowed-extensions: .pdf,.doc,.docx,.xls,.xlsx
    temp-dir: temp/uploads/
  audit:
    max-concurrent-audits: 3
    timeout-minutes: 5

server:
  port: 8080
  shutdown: graceful