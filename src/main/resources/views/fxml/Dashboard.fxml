<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<ScrollPane fitToWidth="true" styleClass="page-scroll-pane" stylesheets="@../css/Dashboard.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.yourapp.controller.DashboardController">
    <content>
        <VBox spacing="25.0" styleClass="page-content">
            <padding>
                <Insets bottom="30.0" left="30.0" right="30.0" top="30.0" />
            </padding>

            <!-- PAGE HEADER -->
            <VBox spacing="5.0">
                <Label fx:id="welcomeLabel" styleClass="page-title" text="Bienvenue, Utilisateur " />
                <Label styleClass="page-subtitle" text="Voici un aperçu de vos audits et de la conformité de votre organisation" />
            </VBox>

            <!-- MAIN CONTENT -->
            <HBox spacing="25.0">
                <!-- LEFT SECTION -->
                <VBox spacing="25.0" HBox.hgrow="ALWAYS">

                    <!-- STATS CARDS -->
                    <GridPane hgap="15.0" vgap="15.0">
                        <columnConstraints>
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" />
                        </columnConstraints>

                        <!-- NOMBRE D'AUDITS -->
                        <VBox prefHeight="145.0" prefWidth="138.0" styleClass="stat-card" GridPane.columnIndex="0">
                            <HBox alignment="TOP_RIGHT">
                                <StackPane prefHeight="42.0" prefWidth="42.0" styleClass="icon-square, bg-muted-blue">
                                    <ImageView fitHeight="22.0" fitWidth="22.0" preserveRatio="true">
                                        <Image url="@../icons/stats.png" />
                                    </ImageView>
                                </StackPane>
                            </HBox>
                            <Label styleClass="stat-label" text="Nombre d'Audits">
                                <font>
                                    <Font name="System Bold" size="12.0" />
                                </font></Label>
                            <Label fx:id="totalAuditsLabel" styleClass="stat-value" text="0" />
                            <Label fx:id="auditsThisMonthLabel" styleClass="stat-badge" text="+0 ce mois" />
                        </VBox>

                        <!-- NOMBRE DE PROJETS -->
                        <VBox styleClass="stat-card" GridPane.columnIndex="1">
                            <HBox alignment="TOP_RIGHT">
                                <StackPane prefHeight="42.0" prefWidth="42.0" styleClass="icon-square, bg-muted-purple">
                                    <ImageView fitHeight="22.0" fitWidth="22.0" preserveRatio="true">
                                        <Image url="@../icons/file.png" />
                                    </ImageView>
                                </StackPane>
                            </HBox>
                            <Label styleClass="stat-label" text="Nombre de Projets" />
                            <Label fx:id="projectsLabel" styleClass="stat-value" text="0" />
                            <Label fx:id="projectsThisWeekLabel" styleClass="stat-badge" text="+0 cette semaine" />
                        </VBox>

                        <!-- AUDIT CONFORME -->
                        <VBox styleClass="stat-card" GridPane.columnIndex="2">
                            <HBox alignment="TOP_RIGHT">
                                <StackPane prefHeight="42.0" prefWidth="42.0" styleClass="icon-square, bg-muted-green">
                                    <ImageView fitHeight="22.0" fitWidth="22.0" preserveRatio="true">
                                        <Image url="@../icons/check-mark.png" />
                                    </ImageView>
                                </StackPane>
                            </HBox>
                            <Label styleClass="stat-label" text="Audit Conforme" />
                            <Label fx:id="conformeLabel" styleClass="stat-value" text="0" />
                            <Label styleClass="stat-badge-success" text="Conforme" />
                        </VBox>

                        <!-- AUDIT NON-CONFORME -->
                        <VBox styleClass="stat-card" GridPane.columnIndex="3">
                            <HBox alignment="TOP_RIGHT">
                                <StackPane prefHeight="42.0" prefWidth="42.0" styleClass="icon-square, bg-muted-orange">
                                    <ImageView fitHeight="22.0" fitWidth="22.0" preserveRatio="true">
                                        <Image url="@../icons/close.png" />
                                    </ImageView>
                                </StackPane>
                            </HBox>
                            <Label styleClass="stat-label" text="Audit Non-Conforme" />
                            <Label fx:id="nonConformeLabel" styleClass="stat-value" text="0" />
                            <Label styleClass="stat-badge-action" text="Action requise" />
                        </VBox>
                        <rowConstraints>
                            <RowConstraints />
                        </rowConstraints>
                    </GridPane>

                    <!-- PROGRESSION DES AUDITS -->
                    <VBox spacing="15.0" styleClass="white-card">
                        <Label styleClass="section-title" text=" Aperçu de la Progression des Audits">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                            <graphic>
                                <ImageView fitHeight="17.0" fitWidth="28.0" preserveRatio="true">
                                    <Image url="@../icons/trend.png" />
                                </ImageView>
                            </graphic>
                        </Label>

                        <!-- SCORE GLOBAL -->
                        <VBox fx:id="complianceCard" styleClass="compliance-card">
                            <HBox alignment="CENTER_LEFT" spacing="20.0">
                                <VBox HBox.hgrow="ALWAYS">
                                    <Label styleClass="card-subtitle-white" text="Score de Conformité Global" />
                                    <Label fx:id="globalScoreLabel" styleClass="compliance-value" text="0%" />
                                    <Label fx:id="complianceStatusLabel" styleClass="card-footer-white" text="Chargement..." />
                                </VBox>
                                <StackPane>
                                    <Circle fill="TRANSPARENT" radius="35.0" stroke="WHITE" strokeWidth="5.0" style="-fx-opacity: 0.3;" />
                                    <ImageView fx:id="complianceStatusIcon" fitHeight="25.0" fitWidth="25.0" pickOnBounds="true" preserveRatio="true">
                                        <Image url="@../icons/check-mark.png" />
                                    </ImageView>
                                </StackPane>
                            </HBox>
                        </VBox>

                        <Label styleClass="section-title" text="Progression par Projet">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        <VBox fx:id="projectProgressContainer" spacing="15.0" />
                    </VBox>

                    <!-- ACTIVITÉS RÉCENTES -->
                    <VBox spacing="15.0" styleClass="white-card">
                        <Label styleClass="section-title" text="Activité Récente">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        <VBox fx:id="recentAuditsContainer" spacing="10.0" />
                    </VBox>
                </VBox>

                <!-- RIGHT SECTION - CHATBOT AI -->
                <VBox prefWidth="350.0" spacing="20.0">
                    <VBox prefHeight="522.0" prefWidth="350.0" spacing="15.0" styleClass="ai-sidebar-card">
                        <HBox alignment="CENTER_LEFT" spacing="15.0">
                            <StackPane prefHeight="46.0" prefWidth="46.0" styleClass="ai-icon-bg">
                                <ImageView fitHeight="25.0" fitWidth="25.0" preserveRatio="true">
                                    <Image url="@../icons/ai.png" />
                                </ImageView>
                            </StackPane>
                            <VBox>
                                <Label styleClass="ai-title" text="Assistant IA" />
                                <Label styleClass="ai-subtitle" text="Assistant intelligent" />
                            </VBox>
                        </HBox>

                        <Separator prefWidth="280.0" />

                        <VBox prefHeight="113.0" prefWidth="280.0" spacing="20.0">
                            <HBox spacing="10.0" styleClass="sidebar-item">
                                <ImageView fitHeight="25.0" fitWidth="25.0" preserveRatio="true">
                                    <Image url="@../icons/bulb.png" />
                                </ImageView>
                                <VBox>
                                    <Label styleClass="sidebar-item-title" text="Recommandations" />
                                    <Label styleClass="sidebar-item-sub" text="3 suggestions pour améliorer" wrapText="true" />
                                </VBox>
                            </HBox>
                            <HBox spacing="10.0" styleClass="sidebar-item">
                                <ImageView fitHeight="25.0" fitWidth="25.0" preserveRatio="true">
                                    <Image url="@../icons/trend.png" />
                                </ImageView>
                                <VBox>
                                    <Label styleClass="sidebar-item-title" text="Tendances" />
                                    <Label styleClass="sidebar-item-sub" text="Analyse des 3 derniers mois" wrapText="true" />
                                </VBox>
                            </HBox>
                            <HBox spacing="10.0" styleClass="sidebar-item">
                                <ImageView fitHeight="25.0" fitWidth="25.0" preserveRatio="true">
                                    <Image url="@../icons/alert.png" />
                                </ImageView>
                                <VBox>
                                    <Label styleClass="sidebar-item-title" text="Alertes" />
                                    <Label styleClass="sidebar-item-sub" text="2 problèmes récurrents détectés " wrapText="true" />
                                </VBox>
                            </HBox>
                        </VBox>

                        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" prefHeight="167.0" prefWidth="310.0" style="-fx-background-color: transparent; -fx-background: transparent;" VBox.vgrow="ALWAYS">
                            <content>
                                <VBox fx:id="aiChatContainer" spacing="10.0" style="-fx-padding: 5;">
                                    <VBox prefHeight="0.0" prefWidth="286.0" styleClass="ai-chat-bubble">
                                        <Label text="Bonjour! Je suis votre assistant IA. Comment puis-je vous aider aujourd'hui?" wrapText="true" />
                                    </VBox>
                                </VBox>
                            </content>
                        </ScrollPane>

                        <HBox spacing="5.0" styleClass="chat-input-container">
                            <TextField fx:id="chatInput" onAction="#handleSendMessage" promptText="Posez une question..." styleClass="chat-field" HBox.hgrow="ALWAYS" />

                            <Button onAction="#handleSendMessage" styleClass="chat-send-btn">
                                <graphic>
                                    <ImageView fitHeight="18.0" fitWidth="18.0" preserveRatio="true">
                                        <Image url="@../icons/send.png" />
                                    </ImageView>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>
                </VBox>
            </HBox>
        </VBox>
    </content>
</ScrollPane>
